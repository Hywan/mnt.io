<!doctype html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="content-security-policy" content="default-src 'self'; child-src 'self' https://www.youtube-nocookie.com; script-src 'self' 'unsafe-inline' 'wasm-unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:">
  <meta name="viewport" content="width=device-width, minimum-scale=1">

  <title>RFCs should provide executable test suites</title>

  <link rel="stylesheet" href="https://mnt.io/style/min/main.css?h=6c0cd873f06c67453a4b">
  <link rel="stylesheet" href="https://mnt.io/style/min/syntax-theme.css?h=ef9797b0398b3ffe9058">
  <link rel="stylesheet" href="https://mnt.io/style/min/search.css" fetchpriority="low">

  <meta name="author" content="Ivan Enderlin">
  <meta name="description" content="I&#x27;ve implemented xCal and xCard formats inside the `sabre&#x2F;dav` libraries. While testing the different RFCs against my implementation, several errata have been found. This article, first, quickly list them and, second, ask questions about how such errors can be present and how they can be easily revealed. If reading my dry humor about RFC errata is boring, the next sections are more interesting. The whole idea is: Why RFCs do not provide executable test suites?">
  <meta name="keywords" content="test, rfc">
  <meta property="og:title" content="RFCs should provide executable test suites">
  <meta property="og:site_name" content="mnt.io">
  <meta property="og:locale" content="en_GB">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://mnt.io/articles/rfcs-should-provide-executable-test-suites/">
  <meta property="og:image" content="https://mnt.io/image/site-poster.jpg">
  <meta name="fediverse:creator" content="@hywan@floss.social">

  <script defer src="https://mnt.io/search/pagefind-ui.js" fetchpriority="low"></script>
</head>
<body class="content-grid">

<nav id="menu" class="full-width content-grid">
  <ul>
    <li><a href="/" accesskey="h">Home</a></li>
    <li><a href="https://mnt.io/articles/" accesskey="a">Articles</a></li>
    <li><a href="https://mnt.io/series/" accesskey="s">Series</a></li>
    <li><a href="https://matrix.to/#/&#x23;mnt_io:matrix.org" title="Public Matrix room to discuss about this blog's content" target="_blank" accesskey="d">Discuss</a></li>
    <li>
      <a href="javascript:document.getElementById('search').showModal()" accesskey="k">
        <svg viewBox="0 0 500 500" class="icon">
          <description>Search</description>
          <circle r="180" cx="210" cy="210" fill="none" stroke="currentColor" stroke-width="40" />
          <line x1="340" y1="340" x2="480" y2="480" stroke="currentColor" stroke-width="40" stroke-linecap="round" />
        </svg>
      </a>
    </li>
  </ul>
</nav>

<dialog id="search" tabindex="-1" closedby="any"></dialog>

<main vocab="https://schema.org">

  <article class="article" typeof="Article" data-pagefind-body>
    <header>
      <h1 property="name" style="view-transition-name: article-title-rfcs-should-provide-executable-test-suites">RFCs should provide executable test suites</h1>

      
  <div class="metadata" data-pagefind-ignore="all">
    <time title="Published date" datetime="2015-02-27" property="datePublished">February 27, 2015</time>
    <span title="Reading time" property="timeRequired" content="PT7M">7 minutes read</span>
    
    <span title="Keywords" property="keywords" content="test, rfc">
      Keywords:&nbsp;<a href="/keywords/test">test</a>, <a href="/keywords/rfc">rfc</a></span>
    
      <span><a href="https://github.com/Hywan/mnt.io/edit/main/content/articles&#x2F;2015-02-27-rfcs-should-provide-executable-test-suites&#x2F;index.md" title="Submit a patch for this page">Edit</a> this page</span>
      
      <meta property="description" content="I&#x27;ve implemented xCal and xCard formats inside the `sabre&#x2F;dav` libraries. While testing the different RFCs against my implementation, several errata have been found. This article, first, quickly list them and, second, ask questions about how such errors can be present and how they can be easily revealed. If reading my dry humor about RFC errata is boring, the next sections are more interesting. The whole idea is: Why RFCs do not provide executable test suites?" />
      
    
  </div>

    </header>

    <p>Recently, I implemented xCal and xCard formats inside the <code>sabre/dav</code> libraries.
While testing the different RFCs against my implementation, several errata have
been found. This article, first, quickly list them and, second, ask questions
about how such errors can be present and how they can be easily revealed. If
reading my dry humor about RFC errata is boring, the next sections are more
interesting. The whole idea is: Why RFCs do not provide executable test suites?</p>
<h2 id="what-is-xcal-and-xcard">What is xCal and xCard?<a role="presentation" class="anchor" href="#what-is-xcal-and-xcard" title="Anchor link to this header">#</a>
</h2>
<p>The Web is a read-only media. It is based on the HTTP protocol. However,
there is the <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/WebDAV">WebDAV</a> protocol,
standing for Web Distributed Authoring and Versioning. This is an
extension to HTTP. <em>Et voilà !</em> The Web is a read and write media.
WebDAV is standardized in <a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc2518">RFC2518</a>
and <a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc4918">RFC4918</a>.</p>
<p>Based on WebDAV, we have <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/CalDAV">CalDAV</a>
and <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/CardDAV">CardDAV</a>, respectively for
reading and writing calendars and addressbooks. They are standardized in
<a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc4791">RFC4791</a>,
<a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc6638">RFC6638</a> and
<a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc6352">RFC6352</a>. Good! But these
protocols only explain how to read and write, not how to represent a
real calendar or an addressbook. So let's leave protocols for formats.</p>
<p>The <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/ICalendar">iCalendar</a> format
represents calendar events, like events (<code>VEVENT</code>), tasks (<code>VTODO</code>),
journal entry (<code>VJOURNAL</code>, very rare…), free/busy time (<code>VFREEBUSY</code>)
etc. The <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/VCard">vCard</a> format represents
cards. The formats are very similar and share a common ancestry: This is
a <strong>horrible</strong> line-, colon- and semicolon-, randomly-escaped based
format. For instance:</p>
<pre class="giallo z-code"><code data-lang="plain"><span class="giallo-l"><span>BEGIN:VCALENDAR</span></span>
<span class="giallo-l"><span>VERSION:2.0</span></span>
<span class="giallo-l"><span>CALSCALE:GREGORIAN</span></span>
<span class="giallo-l"><span>PRODID:-//Example Inc.//Example Calendar//EN</span></span>
<span class="giallo-l"><span>BEGIN:VEVENT</span></span>
<span class="giallo-l"><span>DTSTAMP:20080205T191224Z</span></span>
<span class="giallo-l"><span>DTSTART;VALUE=DATE:20081006</span></span>
<span class="giallo-l"><span>SUMMARY:Planning meeting</span></span>
<span class="giallo-l"><span>UID:4088E990AD89CB3DBB484909</span></span>
<span class="giallo-l"><span>END:VEVENT</span></span>
<span class="giallo-l"><span>END:VCALENDAR</span></span></code></pre>
<p>Horrible, yes. You were warned. These formats are standardized in
several RFCs, to list some of them:
<a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc5545">RFC5545</a>,
<a rel="noopener external" target="_blank" href="http://tools.ietf.org/html/rfc2426">RFC2426</a> and
<a rel="noopener external" target="_blank" href="http://tools.ietf.org/html/rfc6350">RFC6350</a>.</p>
<p>This format is impossible to read, even for a computer. That's why we
have jCal and jCard, which are respectively another representation of
iCalendar and vCard but in <a rel="noopener external" target="_blank" href="http://json.org/">JSON</a>. JSON is quite
popular in the Web today, especially because it eases the manipulation
and exchange of data in Javascript. This is just a very simple, and
—from my point of view— human readable, serialization format. jCal and
jCard are respectively standardized in
<a rel="noopener external" target="_blank" href="http://tools.ietf.org/html/rfc7265">RFC7265</a> and
<a rel="noopener external" target="_blank" href="http://tools.ietf.org/html/rfc7095">RFC7095</a>. Thus, the equivalent of
the previous iCalendar example in jCal is:</p>
<pre class="giallo z-code"><code data-lang="json"><span class="giallo-l"><span>[</span></span>
<span class="giallo-l"><span class="z-string">    &quot;vcalendar&quot;</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>    [</span></span>
<span class="giallo-l"><span>        [</span><span class="z-string">&quot;version&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;text&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;2.0&quot;</span><span>]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>        [</span><span class="z-string">&quot;calscale&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;text&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;GREGORIAN&quot;</span><span>]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>        [</span><span class="z-string">&quot;prodid&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;text&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;-</span><span class="z-constant z-character">\/\/</span><span class="z-string">Example Inc.</span><span class="z-constant z-character">\/\/</span><span class="z-string">Example Calendar</span><span class="z-constant z-character">\/\/</span><span class="z-string">EN&quot;</span><span>]</span></span>
<span class="giallo-l"><span>    ]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>    [</span></span>
<span class="giallo-l"><span>        [</span></span>
<span class="giallo-l"><span class="z-string">            &quot;vevent&quot;</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>            [</span></span>
<span class="giallo-l"><span>                [</span><span class="z-string">&quot;dtstamp&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;date-time&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;2008-02-05T19:12:24Z&quot;</span><span>]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>                [</span><span class="z-string">&quot;dtstart&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;date&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;2008-10-06&quot;</span><span>]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>                [</span><span class="z-string">&quot;summary&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;text&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;Planning meeting&quot;</span><span>]</span><span class="z-punctuation z-separator">,</span></span>
<span class="giallo-l"><span>                [</span><span class="z-string">&quot;uid&quot;</span><span class="z-punctuation z-separator">,</span><span> {}</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;text&quot;</span><span class="z-punctuation z-separator">,</span><span class="z-string"> &quot;4088E990AD89CB3DBB484909&quot;</span><span>]</span></span>
<span class="giallo-l"><span>            ]</span></span>
<span class="giallo-l"><span>        ]</span></span>
<span class="giallo-l"><span>    ]</span></span>
<span class="giallo-l"><span>]</span></span></code></pre>
<p>Much better. But this is JSON, which is a rather loose format, so we
also have xCal and xCard another representation of iCalendar and vCard
but in <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/XML">XML</a>. They are standardized
in <a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc6321">RFC6321</a> and
<a rel="noopener external" target="_blank" href="https://tools.ietf.org/html/rfc6351">RFC6351</a>. The same example in xCal
looks like this:</p>
<pre class="giallo z-code"><code data-lang="xml"><span class="giallo-l"><span class="z-punctuation z-definition z-tag">&lt;</span><span class="z-entity z-name z-tag">icalendar</span><span class="z-entity z-other z-attribute-name"> xmlns</span><span>=</span><span class="z-string">&quot;urn:ietf:params:xml:ns:icalendar-2.0&quot;</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">  &lt;</span><span class="z-entity z-name z-tag">vcalendar</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">    &lt;</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;</span><span class="z-entity z-name z-tag">version</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">        &lt;</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>2.0</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;/</span><span class="z-entity z-name z-tag">version</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;</span><span class="z-entity z-name z-tag">calscale</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">        &lt;</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>GREGORIAN</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;/</span><span class="z-entity z-name z-tag">calscale</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;</span><span class="z-entity z-name z-tag">prodid</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">        &lt;</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>-//Example Inc.//Example Calendar//EN</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;/</span><span class="z-entity z-name z-tag">prodid</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">    &lt;/</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">    &lt;</span><span class="z-entity z-name z-tag">components</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;</span><span class="z-entity z-name z-tag">vevent</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">        &lt;</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;</span><span class="z-entity z-name z-tag">dtstamp</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">            &lt;</span><span class="z-entity z-name z-tag">date-time</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>2008-02-05T19:12:24Z</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">date-time</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;/</span><span class="z-entity z-name z-tag">dtstamp</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;</span><span class="z-entity z-name z-tag">dtstart</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">            &lt;</span><span class="z-entity z-name z-tag">date</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>2008-10-06</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">date</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;/</span><span class="z-entity z-name z-tag">dtstart</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;</span><span class="z-entity z-name z-tag">summary</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">            &lt;</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>Planning meeting</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;/</span><span class="z-entity z-name z-tag">summary</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;</span><span class="z-entity z-name z-tag">uid</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">            &lt;</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span><span>4088E990AD89CB3DBB484909</span><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">text</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">          &lt;/</span><span class="z-entity z-name z-tag">uid</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">        &lt;/</span><span class="z-entity z-name z-tag">properties</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">      &lt;/</span><span class="z-entity z-name z-tag">vevent</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">    &lt;/</span><span class="z-entity z-name z-tag">components</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">  &lt;/</span><span class="z-entity z-name z-tag">vcalendar</span><span class="z-punctuation z-definition z-tag">&gt;</span></span>
<span class="giallo-l"><span class="z-punctuation z-definition z-tag">&lt;/</span><span class="z-entity z-name z-tag">icalendar</span><span class="z-punctuation z-definition z-tag">&gt;</span></span></code></pre>
<p>More semantics, more meaning, easier to read (from my point of view),
namespaces… It is very easy to <strong>embed</strong> xCal and xCard inside other XML
formats.</p>
<p>Managing all these formats is an extremely laborious task. I suggest you
to take a look at <a rel="noopener external" target="_blank" href="http://sabre.io/vobject/"><code>sabre/vobject</code></a> (see <a rel="noopener external" target="_blank" href="https://github.com/fruux/sabre-vobject/">the
Github repository of
<code>sabre/vobject</code></a>). This is a
PHP library to manage all the weird formats. The following example shows
how to read from iCalendar and write to jCal and xCal:</p>
<pre class="giallo z-code"><code data-lang="php"><span class="giallo-l"><span class="z-keyword z-operator">&lt;?</span><span class="z-constant z-other">php</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-comment">// Read iCalendar.</span></span>
<span class="giallo-l"><span class="z-variable">$document</span><span class="z-keyword z-operator"> =</span><span> Sabre</span><span class="z-punctuation z-separator">\</span><span>VObject</span><span class="z-punctuation z-separator">\</span><span class="z-support z-class">Reader</span><span class="z-keyword z-operator">::</span><span class="z-entity z-name z-function">read</span><span>(</span><span class="z-variable">$icalendar</span><span>)</span><span class="z-punctuation z-terminator">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-comment">// Write jCal.</span></span>
<span class="giallo-l"><span class="z-support z-function">echo</span><span> Sabre</span><span class="z-punctuation z-separator">\</span><span>VObject</span><span class="z-punctuation z-separator">\</span><span class="z-support z-class">Writer</span><span class="z-keyword z-operator">::</span><span class="z-entity z-name z-function">writeJson</span><span>(</span><span class="z-variable">$document</span><span>)</span><span class="z-punctuation z-terminator">;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span class="z-comment">// Write xCal.</span></span>
<span class="giallo-l"><span class="z-support z-function">echo</span><span> Sabre</span><span class="z-punctuation z-separator">\</span><span>VObject</span><span class="z-punctuation z-separator">\</span><span class="z-support z-class">Writer</span><span class="z-keyword z-operator">::</span><span class="z-entity z-name z-function">writeXml</span><span>(</span><span class="z-variable">$document</span><span>)</span><span class="z-punctuation z-terminator">;</span></span></code></pre>
<p>Magic when you know the complexity of these formats (in both term of
parsing and validation)!</p>
<h2 id="list-of-errata">List of errata<a role="presentation" class="anchor" href="#list-of-errata" title="Anchor link to this header">#</a>
</h2>
<p>Now, let's talk about all the errata I submited recently:</p>
<ul>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4241">4241, in
RFC6351</a>
(xCard),</li>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4243">4243, in
RFC6351</a>
(xCard),</li>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4246">4246, in
RFC6350</a>
(vCard),</li>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4247">4247, in
RFC6351</a>
(xCard),</li>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4245">4245, in
RFC6350</a>
(vCard),</li>
<li><a rel="noopener external" target="_blank" href="http://www.rfc-editor.org/errata_search.php?eid=4261">4261, in
RFC6350</a>
(vCard).</li>
</ul>
<p>The 2 last ones are reported, not yet verified.</p>
<p>4241, 4243 and 4246 are just typos in examples. “<em>just</em>” is a bit of an
under-statement when you are reading RFCs for days straight, you have 10
of them opened in your browser and trying to figure out how everything
fits together and if you are doing everything correctly. Finding typos
at that point in your process can be very confusing…</p>
<p>4247 is more subtle. The RFC about xCard comes with an <a rel="noopener external" target="_blank" href="https://en.wikipedia.org/wiki/XML_Schema_%28W3C%29">XML
Schema</a>. That's
great! It will help us to test our documents and see if they are valid
or not! No? No.</p>
<p>Most of the time, I try to relax and deal with the incoming problems.
But the date and time format in iCalendar, vCard, jCal, jCard, xCal and
xCard can make my blood boil in a second. In what world, exactly, <code>--10</code>
or <code>---28</code> is a conceivable date and time format? How long did I sleep?
“Well” — was I saying to myself, “do not make a drama, we have the XML
Schema!”. No. Because there is an error in the schema. More precisely,
in a regular expression:</p>
<pre class="giallo z-code"><code data-lang="plain"><span class="giallo-l"><span>value-time = element time {</span></span>
<span class="giallo-l"><span>    xsd:string { pattern = &quot;(\d\d(\d\d(\d\d)?)?|-\d\d(\d\d?)|--\d\d)&quot;</span></span>
<span class="giallo-l"><span>                         ~ &quot;(Z|[+\-]\d\d(\d\d)?)?&quot; }</span></span>
<span class="giallo-l"><span>}</span></span></code></pre>
<p>Did you find the error? <code>(\d\d?)</code> is invalid, this is <code>(\d\d)?</code>. Don't
get me wrong: Everyone makes mistakes, but not this kind of error. I
will explain why in the next section.</p>
<p>4245 is not an editorial error but a technical one, under review.</p>
<p>4261 is crazy. It deserves a whole sub-section.</p>
<h3 id="welcome-in-the-crazy-world-of-date-and-time-formats">Welcome in the crazy world of date and time formats<a role="presentation" class="anchor" href="#welcome-in-the-crazy-world-of-date-and-time-formats" title="Anchor link to this header">#</a>
</h3>
<p>There are two major popular date and time format:
<a rel="noopener external" target="_blank" href="http://tools.ietf.org/html/rfc2822">RFC2822</a> and ISO.8601. Examples:</p>
<ul>
<li><code>Fri, 27 Feb 2015 16:06:58 +0100</code> and</li>
<li><code>2015-02-27T16:07:16+01:00</code>.</li>
</ul>
<p>The second one is a good candidate for a computer representation: no
locale, only digits, all information are present…</p>
<p>Maybe you noticed there is no link on ISO.8601. Why? Because ISO
standards are not free and I don't want <a rel="noopener external" target="_blank" href="http://www.iso.org/iso/catalogue_detail?csnumber=40874">to pay
140€</a> to buy a
standard…</p>
<p>The date and time format adopted by iCalendar and vCard (and the rest of
the family) is ISO.8601.2004. I cannot read it. However, since we said
in xCard we have an XML Schema; we can read this (after having applied
erratum 4247):</p>
<pre class="giallo z-code"><code data-lang="plain"><span class="giallo-l"><span># 4.3.1</span></span>
<span class="giallo-l"><span>value-date = element date {</span></span>
<span class="giallo-l"><span>    xsd:string { pattern = &quot;\d{8}|\d{4}-\d\d|--\d\d(\d\d)?|---\d\d&quot; }</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span># 4.3.2</span></span>
<span class="giallo-l"><span>value-time = element time {</span></span>
<span class="giallo-l"><span>    xsd:string { pattern = &quot;(\d\d(\d\d(\d\d)?)?|-\d\d(\d\d)?|--\d\d)&quot;</span></span>
<span class="giallo-l"><span>                         ~ &quot;(Z|[+\-]\d\d(\d\d)?)?&quot; }</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span># 4.3.3</span></span>
<span class="giallo-l"><span>value-date-time = element date-time {</span></span>
<span class="giallo-l"><span>    xsd:string { pattern = &quot;(\d{8}|--\d{4}|---\d\d)T\d\d(\d\d(\d\d)?)?&quot;</span></span>
<span class="giallo-l"><span>                         ~ &quot;(Z|[+\-]\d\d(\d\d)?)?&quot; }</span></span>
<span class="giallo-l"><span>}</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span># 4.3.4</span></span>
<span class="giallo-l"><span>value-date-and-or-time = value-date | value-date-time | value-time</span></span></code></pre>
<p>Question: <strong><code>--10</code> is October or 10 seconds</strong>?</p>
<p><code>--10</code> can fit into <code>value-date</code> and <code>value-time</code>:</p>
<ul>
<li>From <code>value-date</code>, the 3rd element in the disjunction is <code>--\d\d(\d\d)?</code>, so
it matches <code>--10</code> ,</li>
<li>From <code>value-time</code>, the last element in the first disjunction is <code>--\d\d</code>, so
it matches <code>--10</code>.</li>
</ul>
<p>If we have a date-and-or-time value, <code>value-date</code> comes first, so <code>--10</code>
is always October. Nevertheless, if we have a time value, <code>--10</code> is
10 seconds. Crazy now?</p>
<p>Oh, and XML has its own date and time format, which is well-defined and
standardized. Why should we drag this crazy format along?</p>
<p>Oh, and I assume every format depending on ISO.8601.2004 has this bug.
But I am not sure because ISO standards are not free.</p>
<h2 id="how-can-rfcs-have-such-errors">How can RFCs have such errors?<a role="presentation" class="anchor" href="#how-can-rfcs-have-such-errors" title="Anchor link to this header">#</a>
</h2>
<p>So far, RFCs are textual standards. Great. But they are just text.
Written by humans, and thus they are subject to errors or failures. It
is even error-prone. I do not understand: Why an RFC does not come with
an <strong>executable test suite</strong>? I am pretty sure every reader of an RFC
will try to create a test suite on its own.</p>
<p>I assume xCal and xCard formats are not yet very popular. Consequently,
few people read the RFC and tried to write an implementation. This is my
guess. However, it does not avoid the fact an executable test suite
should (must?) be provided.</p>
<h2 id="how-did-i-find-them">How did I find them?<a role="presentation" class="anchor" href="#how-did-i-find-them" title="Anchor link to this header">#</a>
</h2>
<p>This is how I found these errors. I wrote <a rel="noopener external" target="_blank" href="https://github.com/fruux/sabre-vobject/blob/master/tests/VObject/Parser/XmlTest.php">a test suite for xCal and
xCard in
<code>sabre/vobject</code></a>.
I would love to write a test suite agnostic of the implementation, but I
ran out of time. This is basically format transformation: R:x→y where R
can be a reflexive operator or not (depending of the versions of
iCalendar and vCard we consider).</p>
<p>For “simple“ errata, I found the errors by testing it manually. For errata 4247
and 4261 (with the regular expressions), I found the error by applying the
algorithms presented in
<a href="https://mnt.io/articles/generate-strings-based-on-regular-expressions/">Generate strings based on regular expressions</a>
.</p>
<h2 id="conclusion">Conclusion<a role="presentation" class="anchor" href="#conclusion" title="Anchor link to this header">#</a>
</h2>
<p><code>sabre/vobject</code> supports xCal and xCard.</p>


    <nav class="previous-next-articles"><a href="https:&#x2F;&#x2F;mnt.io&#x2F;articles&#x2F;control-the-terminal-the-right-way&#x2F;" class="button text-align-start" style="view-transition-name: article-title-control-the-terminal-the-right-way">❮&nbsp;Control the terminal, the right way</a><a href="https:&#x2F;&#x2F;mnt.io&#x2F;articles&#x2F;sabre-katana-a-contact-calendar-task-list-and-file-server&#x2F;" class="button text-align-end" style="view-transition-name: article-title-sabre-katana-a-contact-calendar-task-list-and-file-server">sabre&#x2F;katana&nbsp;❯</a></nav>
  </article>

</main>

<footer class="full-width content-grid">
  <div class="footer">
    <div>
      <h2>Contact me</h2>

      <ul>
        <li><a href="https://matrix.to/#/@mnt_io:matrix.org" title="Say hi on Matrix">@mnt_io:matrix.org</a></li>
        <li><a href="mailto:ivan@mnt.io" title="Good ol' email">ivan@mnt.io</a></li>
        <li><a href="https://floss.social/@hywan" title="Say hi on Mastodon" rel="me">Mastodon</a></li>
        <li><a href="https://github.com/Hywan" title="Say hi on Github">Github</a></li>
      </ul>
    </div>
    <div>
      <h2>Recommendations</h2>

      <ul>
        <li><a href="https://fasterthanli.me/">fasterthanli.me</a></li>
        <li><a href="https://without.boats/blog/">without.boats</a></li>
        <li><a href="https://faultlore.com/blah/">faultlore</a></li>
        <li><a href="https://smallcultfollowing.com/babysteps/blog/">smallcultfollowing</a></li>
        <li><a href="https://orlp.net/blog/">orlp</a></li>
        <li><a href="https://blog.m-ou.se/">m-ou.se</a></li>
        <li><a href="https://nadrieril.github.io/">nadrieril</a></li>
      </ul>
    </div>

    <div>
      <h2>More</h2>

      <ul>
        <li><a href="https://mnt.io/lore/">Lore</a></li>
        <li><a href="https://mnt.io/rss.xml">RSS</a></li>
        <li><a href="https://mnt.io/atom.xml">Atom</a></li>
        <li><a href="https://github.com/Hywan/mnt.io" title="Source code of this site">Source code</a></li>
        <li><a href="https://dblp.org/search/index.php?query=Ivan%20Enderlin" title="Computer Science Bibliography">DBLP</a></li>
      </ul>
    </div>
  </div>
</footer>

<script>
  window.addEventListener('DOMContentLoaded', (_event) => {
    new PagefindUI({
      element: "#search",
      resetStyles: false,
      showSubResults: true,
      showImages: false,
    });
  });
</script>
</body>
</html>
